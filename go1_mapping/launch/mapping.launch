<?xml version="1.0"?>
<launch>

    <param name="robot_description" textfile="$(find go1_robot_description)/urdf/robot_simple.xml" />

    <node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher" />

      <!-- convert joint states to TF transforms for rviz, etc -->
    <node pkg="robot_state_publisher" type="robot_state_publisher" name="robot_state_publisher">
      <param name="publish_frequency" type="double" value="50.0" />  
    </node>

          <!-- tf from map to base publisher -->
    <node pkg="go1_mapping" type="point_cloud2_subscriber_local.py" name="pc2_local" output="screen"/>

    <node pkg="pointcloud_to_laserscan" type="pointcloud_to_laserscan_node" name="pointcloud_to_laserscan">
        <remap from="cloud_in" to="/lidar_pc2" />
        <remap from="scan" to="/lidar/scan" />
        
        <param name="target_frame" value="rslidar"/>
        <param name="transform_tolerance" value="0.1"/>
        <param name="min_height" value="0.0"/>
        <param name="max_height" value="0.3"/>
        <param name="angle_min" value="-1.5708"/>
        <param name="angle_max" value="1.5708"/>
        <param name="range_min" value="0.12"/>
        <param name="range_max" value="10.0"/>
    </node>

      <!-- tf from map to trunk publisher -->
    <!-- <node pkg="go1_mapping" type="map_to_trunk_tf_publisher.py" name="map2trunk_tf" output="screen"/> -->

    <node pkg="gmapping" type="slam_gmapping" name="gmapping">
        <param name="base_frame" value="trunk"/>
        <param name="odom_frame" value="odom"/>   
      
        <remap from="scan" to="/lidar/scan"/>
        <param name="transform_tolerance" value="0.1" />
    </node>  


  <!-- <node pkg="hector_mapping" type="hector_mapping" name="hector_mapping" output="screen">

    <remap from="scan" to="/lidar/scan"/>
    <param name="base_frame" value="trunk"/>
    <param name="odom_frame" value="odom"/>
    <param name="map_frame" value="base"/>
    <param name="pub_map_odom_transform" value="true"/>
    <param name="map_resolution" value="0.05"/> 
    <param name="map_size" value="1024"/>
    <param name="map_pub_period" value="1.0"/>
    <param name="update_factor_free" value="0.4"/>
    <param name="update_factor_occupied" value="0.85"/>
    <param name="laser_max_dist" value="10.0"/> 
    <param name="laser_min_dist" value="0.5"/>
    <param name="tf_prefix" value=""/>
    <param name="transform_tolerance" value="1"/>
    </node> -->
    <!-- <node pkg="go1_mapping" type="map_to_tf_publisher.py" name="map2trunk_tf" output="screen"/> -->
      <!-- Rviz -->
    <node pkg="rviz" type="rviz" name="rviz" args="-d $(find go1_mapping)/config/go1_map.rviz"/>


</launch>







  <!-- <node pkg="hector_mapping" type="hector_mapping" name="hector_mapping" output="screen">

    <remap from="scan" to="/lidar/scan"/>
    <param name="base_frame" value="base_link"/>
    <param name="odom_frame" value="uodom"/>
    <param name="map_frame" value="map"/>
    <param name="pub_map_odom_transform" value="true"/>
    <param name="map_resolution" value="0.05"/> 
    <param name="map_size" value="1024"/>
    <param name="map_pub_period" value="1.0"/>
    <param name="update_factor_free" value="0.4"/>
    <param name="update_factor_occupied" value="0.85"/>
    <param name="laser_max_dist" value="10.0"/> 
    <param name="laser_min_dist" value="0.5"/>
    </node> -->

<!-- 
    <node pkg="laser_scan_matcher" type="laser_scan_matcher_node" name="scan_matcher" output="screen">
        <remap from="scan" to="/lidar/scan"/>
        
        <param name="fixed_frame" value="odom"/>  
        <param name="base_frame" value="base_link"/> 
        <param name="publish_tf" value="true"/> 
        <param name="use_cloud_input" value="false"/>
        <param name="use_alpha_beta" value="true"/>
    </node> -->